name: main
run-name: main
on: 
  workflow_dispatch:
  push:
    branches: 
      - '**main'
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: checkout code
        id: checkout-code-1
        uses: actions/checkout@v3
        with:
         token: ${{ secrets.GH_T }}
         repository: 'vivekacoustic/ghaction'
         ref: main
         path: gh1
         fetch-depth: 0
         
      - name: checkout code
        id: checkout-code-2
        uses: actions/checkout@v3
        with:
         token: ${{ secrets.GH_T }}
         path: gh2
         fetch-depth: 0

      - name: push to other repo
        run: |
          echo "gh1" && ls gh1/.github/workflows/
          echo "gh2" && ls gh2/.github/workflows/
          cp gh1/.github/workflows/test.yml gh2/.github/workflows/
          cd gh2
          git config --global user.name "vivek"
          git config --global user.email "don@example.com"
          git remote add dest https://github.com/vivekacoustic/ghaction.git
          git checkout -b "cloned_branch"
          git push dest -f


          
